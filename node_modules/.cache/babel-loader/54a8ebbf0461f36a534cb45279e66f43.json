{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\user\\\\Desktop\\\\Repositories\\\\starter-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:\\\\Users\\\\user\\\\Desktop\\\\Repositories\\\\starter-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\user\\\\Desktop\\\\Repositories\\\\starter-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\user\\\\Desktop\\\\Repositories\\\\starter-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\user\\\\Desktop\\\\Repositories\\\\starter-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\user\\\\Desktop\\\\Repositories\\\\starter-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\Repositories\\\\starter-app\\\\src\\\\app\\\\module\\\\profile\\\\profile.container.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { action } from '../../../index';\nimport { Grid, Paper, Table, TableCell, TableRow, ExpansionPanel, ExpansionPanelSummary, Typography, ExpansionPanelDetails, TextField, DialogActions, Button } from \"@material-ui/core\";\nimport { fetchMainUserData } from './profile.actions';\nimport { handleLogout, hasAnyRole, refreshToken } from './../../shared/app.properties';\nimport Redirect from 'react-router-dom/Redirect';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { resetPasswordUser } from './../users/users.repo';\n\nvar ProfileContainer =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ProfileContainer, _React$Component);\n\n  function ProfileContainer() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ProfileContainer);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ProfileContainer)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.loading = false;\n    _this.unauthorized = false;\n    _this.state = {\n      newPassword: '',\n      confirmPassword: '',\n      error: false\n    };\n\n    _this.handleUserFormChange = function (name) {\n      return function (event) {\n        _this.setState(_defineProperty({}, name, event.target.value));\n      };\n    };\n\n    _this.handleSubmit = function (event) {\n      event.preventDefault();\n\n      if (_this.state.newPassword === _this.state.confirmPassword) {\n        var u = _this.props.singleuser;\n        u['password'] = _this.state.newPassword;\n        resetPasswordUser({\n          user: u\n        }).then(function (res) {\n          handleLogout();\n          window.location.replace(\"/login\");\n        });\n      } else {\n        _this.setState({\n          error: true\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(ProfileContainer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.fetchMainUserData();\n      this.unauthorized = !hasAnyRole('ROLE_ADMINISTRATION');\n      var refreshTime = new Date();\n      refreshTime.setSeconds(refreshTime.getSeconds() + 1800);\n\n      if (!localStorage.getItem('idm') || !localStorage.getItem('me')) {\n        handleLogout();\n      } else if (localStorage.getItem('idm') && new Date(JSON.parse(localStorage.getItem('idm')).expires_at) < new Date()) {\n        handleLogout();\n      } else if (localStorage.getItem('idm') && new Date(JSON.parse(localStorage.getItem('idm')).expires_at) < refreshTime) {\n        refreshToken();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.props.singleuser) {}\n\n      return React.createElement(\"div\", {\n        className: \"my-profile\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, localStorage.getItem('idm') && localStorage.getItem('me') && this.unauthorized && React.createElement(Redirect, {\n        to: \"/app/error/unauthorized\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }), React.createElement(\"h3\", {\n        style: {\n          marginLeft: 30 + 'px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, \"MY PROFILE\"), React.createElement(Paper, {\n        style: {\n          marginLeft: 30 + \"px\",\n          marginRight: 30 + 'px',\n          padding: 10 + 'px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        xs: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, this.props.singleuser && React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, React.createElement(Table, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, React.createElement(TableRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, \"Username\"), React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, this.props.singleuser.username)), React.createElement(TableRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, \"First name\"), React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, this.props.singleuser.name)), React.createElement(TableRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, \"Last name\"), React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, this.props.singleuser.surname)), React.createElement(TableRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, \"E-mail\"), React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, this.props.singleuser.email))), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }), React.createElement(ExpansionPanel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, React.createElement(ExpansionPanelSummary, {\n        expandIcon: React.createElement(ExpandMoreIcon, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, \"Reset Password\")), React.createElement(ExpansionPanelDetails, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        autoComplete: \"off\",\n        maxWidth: \"md\",\n        className: \"dialog-form-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        id: \"last-name\",\n        fullWidth: true,\n        onChange: this.handleUserFormChange('newPassword'),\n        label: \"New Password:\",\n        value: this.state.newPassword ? this.state.newPassword : '',\n        margin: \"normal\",\n        type: \"password\",\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        id: \"email-name\",\n        fullWidth: true,\n        label: \"Confirm Password\",\n        onChange: this.handleUserFormChange('confirmPassword'),\n        value: this.state.confirmPassword ? this.state.confirmPassword : '',\n        margin: \"normal\",\n        type: \"password\",\n        error: this.state.error,\n        helperText: this.state.error ? 'Must match the previous entry' : '',\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }), React.createElement(DialogActions, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(Button, {\n        type: \"submit\",\n        color: \"primary\",\n        variant: \"contained\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, \"Reset\"))))))))));\n    }\n  }]);\n\n  return ProfileContainer;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    singleuser: state.profileReducer.singleuser\n  };\n};\n\nexport default connect(mapStateToProps, {\n  fetchMainUserData: fetchMainUserData\n})(ProfileContainer);","map":{"version":3,"sources":["C:/Users/user/Desktop/Repositories/starter-app/src/app/module/profile/profile.container.js"],"names":["React","connect","action","Grid","Paper","Table","TableCell","TableRow","ExpansionPanel","ExpansionPanelSummary","Typography","ExpansionPanelDetails","TextField","DialogActions","Button","fetchMainUserData","handleLogout","hasAnyRole","refreshToken","Redirect","ExpandMoreIcon","resetPasswordUser","ProfileContainer","loading","unauthorized","state","newPassword","confirmPassword","error","handleUserFormChange","name","event","setState","target","value","handleSubmit","preventDefault","u","props","singleuser","user","then","res","window","location","replace","refreshTime","Date","setSeconds","getSeconds","localStorage","getItem","JSON","parse","expires_at","marginLeft","marginRight","padding","username","surname","email","Component","mapStateToProps","profileReducer"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { action } from '../../../index';\r\n\r\nimport { Grid, Paper, Table, TableCell, TableRow, ExpansionPanel, ExpansionPanelSummary, Typography, ExpansionPanelDetails, TextField, DialogActions, Button, } from \"@material-ui/core\";\r\nimport { fetchMainUserData } from './profile.actions';\r\nimport { handleLogout, hasAnyRole, refreshToken } from './../../shared/app.properties';\r\nimport Redirect from 'react-router-dom/Redirect';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport {resetPasswordUser} from './../users/users.repo';\r\n\r\nclass ProfileContainer extends React.Component {\r\n\r\n    loading = false;\r\n\r\n    unauthorized = false;\r\n\r\n    state = {\r\n        newPassword: '',\r\n        confirmPassword: '',\r\n        error: false,\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.fetchMainUserData();\r\n\r\n        this.unauthorized = !hasAnyRole('ROLE_ADMINISTRATION');\r\n\r\n        let refreshTime = new Date();\r\n        refreshTime.setSeconds(refreshTime.getSeconds() + 1800);\r\n\r\n        if (!localStorage.getItem('idm') || !localStorage.getItem('me')) {\r\n            handleLogout()\r\n        } else if (localStorage.getItem('idm') && new Date(JSON.parse(localStorage.getItem('idm')).expires_at) < new Date()) {\r\n            handleLogout()\r\n        } else if (localStorage.getItem('idm') && new Date(JSON.parse(localStorage.getItem('idm')).expires_at) < refreshTime) {\r\n            refreshToken()\r\n        }\r\n    }\r\n\r\n    handleUserFormChange = name => event => {\r\n        this.setState({\r\n            [name]: event.target.value\r\n        });\r\n    };\r\n\r\n    handleSubmit = (event) => {\r\n        event.preventDefault();\r\n        if (this.state.newPassword === this.state.confirmPassword) {\r\n            let u = this.props.singleuser;\r\n            u['password']= this.state.newPassword;\r\n            resetPasswordUser({user:u}).then( res =>{\r\n                handleLogout();\r\n                window.location.replace(\"/login\")\r\n            })\r\n        }\r\n        else {\r\n            this.setState({\r\n                error: true\r\n            })\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (this.props.singleuser) {\r\n\r\n        }\r\n        return (\r\n            <div className=\"my-profile\">\r\n                {localStorage.getItem('idm') && localStorage.getItem('me') && this.unauthorized &&\r\n                    <Redirect to=\"/app/error/unauthorized\" />\r\n                }\r\n                <h3 style={{ marginLeft: 30 + 'px' }}>MY PROFILE</h3>\r\n                <Paper style={{ marginLeft: 30 + \"px\", marginRight: 30 + 'px', padding: 10 + 'px' }}>\r\n\r\n                    <Grid>\r\n                        <Grid xs={6}>\r\n                            {this.props.singleuser &&\r\n                            <div>\r\n                                <Table>\r\n                                    <TableRow>\r\n                                        <TableCell>Username</TableCell>\r\n                                        <TableCell>{this.props.singleuser.username}</TableCell>\r\n                                    </TableRow>\r\n                                    <TableRow>\r\n                                        <TableCell>First name</TableCell>\r\n                                        <TableCell>{this.props.singleuser.name}</TableCell>\r\n                                    </TableRow>\r\n                                    <TableRow>\r\n                                        <TableCell>Last name</TableCell>\r\n                                        <TableCell>{this.props.singleuser.surname}</TableCell>\r\n                                    </TableRow>\r\n                                    <TableRow>\r\n                                        <TableCell>E-mail</TableCell>\r\n                                        <TableCell>{this.props.singleuser.email}</TableCell>\r\n                                    </TableRow>\r\n\r\n                                </Table>\r\n                                <br/><br/>\r\n                                <ExpansionPanel >\r\n                                    <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\r\n                                        <Typography >Reset Password</Typography>\r\n                                    </ExpansionPanelSummary>\r\n                                    <ExpansionPanelDetails>\r\n                                    <form onSubmit={this.handleSubmit} autoComplete=\"off\" maxWidth=\"md\" className=\"dialog-form-container\" >\r\n                                    <TextField\r\n                                        id=\"last-name\"\r\n                                        fullWidth={true}\r\n                                        onChange={this.handleUserFormChange('newPassword')}\r\n                                        label=\"New Password:\"\r\n                                        value={this.state.newPassword ? this.state.newPassword : ''}\r\n                                        margin=\"normal\"\r\n                                        type=\"password\"\r\n                                        required\r\n                                    />\r\n                                    <TextField\r\n                                        id=\"email-name\"\r\n                                        fullWidth={true}\r\n                                        label=\"Confirm Password\"\r\n                                        onChange={this.handleUserFormChange('confirmPassword')}\r\n                                        value={this.state.confirmPassword ? this.state.confirmPassword : ''}\r\n                                        margin=\"normal\"\r\n                                        type=\"password\"\r\n                                        error={this.state.error}\r\n                                        helperText={this.state.error ? 'Must match the previous entry' : ''}\r\n                                        required\r\n                                    />\r\n                                    <DialogActions>\r\n                                        <Button type=\"submit\" color=\"primary\" variant=\"contained\">\r\n                                            Reset\r\n                                        </Button>\r\n                                    </DialogActions>\r\n                                </form>\r\n                                    </ExpansionPanelDetails>\r\n                                </ExpansionPanel>\r\n                                </div>\r\n                            }\r\n                        </Grid>\r\n                    </Grid>\r\n                </Paper>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        singleuser: state.profileReducer.singleuser\r\n    }\r\n};\r\n\r\nexport default connect(mapStateToProps, ({\r\n    fetchMainUserData\r\n}))(ProfileContainer);\r\n\r\n"]},"metadata":{},"sourceType":"module"}